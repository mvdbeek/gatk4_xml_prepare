<tool id="gatk4_haplotypecaller" name="GATK4 HaplotypeCaller" profile="17.09" version="@WRAPPER_VERSION@0">
  <description>- Call germline SNPs and indels via local re-assembly of haplotypes</description>
  <macros>
    <import>macros.xml</import>
  </macros>
  <expand macro="requirements"/>
  <expand macro="version_cmd"/>
  <command detect_errors="exit_code"><![CDATA[#include source=$bam_index#
#include source=$pre_gatk_ints_chth#
#include source=$pre_gatk_excl_ints_chth#
#if $alleles:
#set datatype = $alleles.datatype
#if $alleles.is_of_type("vcf_bgzip"):
ln -s $alleles alleles.vcf.gz &&
tabix alleles.vcf.gz &&
#else
ln -s $alleles alleles.vcf &&
#end if
#end if
#if $comp:
#set datatype = $comp.datatype
#if $comp.is_of_type("vcf_bgzip"):
ln -s $comp comp.vcf.gz &&
tabix comp.vcf.gz &&
#else
ln -s $comp comp.vcf &&
#end if
#end if
#if $dbsnp:
#set datatype = $dbsnp.datatype
#if $dbsnp.is_of_type("vcf_bgzip"):
ln -s $dbsnp dbsnp.vcf.gz &&
tabix dbsnp.vcf.gz &&
#else
ln -s $dbsnp dbsnp.vcf &&
#end if
#end if
#if $population_callset:
#set datatype = $population_callset.datatype
#if $population_callset.is_of_type("vcf_bgzip"):
ln -s $population_callset population_callset.vcf.gz &&
tabix population_callset.vcf.gz &&
#else
ln -s $population_callset population_callset.vcf &&
#end if
#end if
@CMD_BEGIN@ HaplotypeCaller
#if $active_probability_threshold:
--active-probability-threshold $active_probability_threshold
#end if
#if $activity_profile_out_sel:
--activity-profile-out $activity_profile_out
#end if
#if $add_output_sam_program_record:
$add_output_sam_program_record
#end if
#if $add_output_vcf_command_line:
$add_output_vcf_command_line
#end if
#if $all_site_pls:
$all_site_pls
#end if
#if $alleles:
#if $alleles.is_of_type("vcf_bgzip"):
--alleles alleles.vcf.gz
#else
--alleles alleles.vcf
#end if
#end if
#if $allow_non_unique_kmers_in_ref:
$allow_non_unique_kmers_in_ref
#end if
#if $annotate_with_num_discovered_alleles:
$annotate_with_num_discovered_alleles
#end if
#if $assembly_region_out_sel:
--assembly-region-out $assembly_region_out
#end if
#if $assembly_region_padding:
--assembly-region-padding $assembly_region_padding
#end if
#if $bam_output_sel:
--bam-output $bam_output
#end if
#if $bam_writer_type:
--bam-writer-type $bam_writer_type
#end if
#if $base_quality_score_threshold:
--base-quality-score-threshold $base_quality_score_threshold
#end if
#if $cloud_index_prefetch_buffer:
--cloud-index-prefetch-buffer $cloud_index_prefetch_buffer
#end if
#if $cloud_prefetch_buffer:
--cloud-prefetch-buffer $cloud_prefetch_buffer
#end if
#if $comp:
#if $comp.is_of_type("vcf_bgzip"):
--comp comp.vcf.gz
#else
--comp comp.vcf
#end if
#end if
#if $consensus:
$consensus
#end if
#if $contamination_fraction_per_sample_file:
--contamination-fraction-per-sample-file $contamination_fraction_per_sample_file
#end if
#if $contamination_fraction_to_filter:
--contamination-fraction-to-filter $contamination_fraction_to_filter
#end if
#if $create_output_bam_index:
$create_output_bam_index
#end if
#if $create_output_bam_md5:
$create_output_bam_md5
#end if
#if $create_output_variant_index:
$create_output_variant_index
#end if
#if $create_output_variant_md5:
$create_output_variant_md5
#end if
#if $dbsnp:
#if $dbsnp.is_of_type("vcf_bgzip"):
--dbsnp dbsnp.vcf.gz
#else
--dbsnp dbsnp.vcf
#end if
#end if
#if $debug:
$debug
#end if
#if $disable_bam_index_caching:
$disable_bam_index_caching
#end if
#if $disable_optimizations:
$disable_optimizations
#end if
#if $disable_read_filter:
--disable-read-filter $disable_read_filter
#end if
#if $disable_sequence_dictionary_validation:
$disable_sequence_dictionary_validation
#end if
#if $disable_tool_default_annotations:
$disable_tool_default_annotations
#end if
#if $disable_tool_default_read_filters:
$disable_tool_default_read_filters
#end if
#if $do_not_run_physical_phasing:
$do_not_run_physical_phasing
#end if
#if $dont_increase_kmer_sizes_for_cycles:
$dont_increase_kmer_sizes_for_cycles
#end if
#if $dont_trim_active_regions:
$dont_trim_active_regions
#end if
#if $dont_use_soft_clipped_bases:
$dont_use_soft_clipped_bases
#end if
#if $emit_ref_confidence:
--emit-ref-confidence $emit_ref_confidence
#end if
#if $enable_all_annotations:
$enable_all_annotations
#end if
#if $founder_id:
--founder-id $founder_id
#end if
#if $gatk_config_file:
--gatk-config-file $gatk_config_file
#end if
#if $gcs_max_retries:
--gcs-max-retries $gcs_max_retries
#end if
#if $genotype_filtered_alleles:
$genotype_filtered_alleles
#end if
#if $genotyping_mode:
--genotyping-mode $genotyping_mode
#end if
#if $graph_output_sel:
--graph-output $graph_output
#end if
#if $gvcf_gq_bands:
--gvcf-gq-bands $gvcf_gq_bands
#end if
#if $heterozygosity:
--heterozygosity $heterozygosity
#end if
#if $heterozygosity_stdev:
--heterozygosity-stdev $heterozygosity_stdev
#end if
#if $indel_heterozygosity:
--indel-heterozygosity $indel_heterozygosity
#end if
#if $indel_size_to_eliminate_in_ref_model:
--indel-size-to-eliminate-in-ref-model $indel_size_to_eliminate_in_ref_model
#end if
#if $input_prior:
--input-prior $input_prior
#end if
#if $interval_merging_rule:
--interval-merging-rule $interval_merging_rule
#end if
#if $interval_set_rule:
--interval-set-rule $interval_set_rule
#end if
#if $kmer_size:
--kmer-size $kmer_size
#end if
#if $lenient:
$lenient
#end if
#if $max_alternate_alleles:
--max-alternate-alleles $max_alternate_alleles
#end if
#if $max_assembly_region_size:
--max-assembly-region-size $max_assembly_region_size
#end if
#if $max_genotype_count:
--max-genotype-count $max_genotype_count
#end if
#if $max_mnp_distance:
--max-mnp-distance $max_mnp_distance
#end if
#if $max_num_haplotypes_in_population:
--max-num-haplotypes-in-population $max_num_haplotypes_in_population
#end if
#if $max_prob_propagation_distance:
--max-prob-propagation-distance $max_prob_propagation_distance
#end if
#if $max_reads_per_alignment_start:
--max-reads-per-alignment-start $max_reads_per_alignment_start
#end if
#if $min_assembly_region_size:
--min-assembly-region-size $min_assembly_region_size
#end if
#if $min_base_quality_score:
--min-base-quality-score $min_base_quality_score
#end if
#if $min_dangling_branch_length:
--min-dangling-branch-length $min_dangling_branch_length
#end if
#if $min_pruning:
--min-pruning $min_pruning
#end if
#if $native_pair_hmm_threads:
--native-pair-hmm-threads $native_pair_hmm_threads
#end if
#if $native_pair_hmm_use_double_precision:
$native_pair_hmm_use_double_precision
#end if
#if $num_pruning_samples:
--num-pruning-samples $num_pruning_samples
#end if
#if $num_reference_samples_if_no_call:
--num-reference-samples-if-no-call $num_reference_samples_if_no_call
#end if
#if $output_mode:
--output-mode $output_mode
#end if
#if $pair_hmm_gap_continuation_penalty:
--pair-hmm-gap-continuation-penalty $pair_hmm_gap_continuation_penalty
#end if
#if $pair_hmm_implementation:
--pair-hmm-implementation $pair_hmm_implementation
#end if
#if $pcr_indel_model:
--pcr-indel-model $pcr_indel_model
#end if
#if $pedigree:
--pedigree $pedigree
#end if
#if $phred_scaled_global_read_mismapping_rate:
--phred-scaled-global-read-mismapping-rate $phred_scaled_global_read_mismapping_rate
#end if
#if $population_callset:
#if $population_callset.is_of_type("vcf_bgzip"):
--population-callset population_callset.vcf.gz
#else
--population-callset population_callset.vcf
#end if
#end if
#if $read_filter:
--read-filter $read_filter
#end if
#if $read_validation_stringency:
--read-validation-stringency $read_validation_stringency
#end if
#if $recover_dangling_heads:
$recover_dangling_heads
#end if
#if $sample_name:
--sample-name $sample_name
#end if
#if $sample_ploidy:
--sample-ploidy $sample_ploidy
#end if
#if $seconds_between_progress_updates:
--seconds-between-progress-updates $seconds_between_progress_updates
#end if
#if $sites_only_vcf_output:
$sites_only_vcf_output
#end if
#if $smith_waterman:
--smith-waterman $smith_waterman
#end if
#if $standard_min_confidence_threshold_for_calling:
--standard-min-confidence-threshold-for-calling $standard_min_confidence_threshold_for_calling
#end if
#if $use_alleles_trigger:
$use_alleles_trigger
#end if
#if $use_filtered_reads_for_annotations:
$use_filtered_reads_for_annotations
#end if
#if $use_jdk_deflater:
$use_jdk_deflater
#end if
#if $use_jdk_inflater:
$use_jdk_inflater
#end if
#if $use_new_qual_calculator:
$use_new_qual_calculator
#end if
#if $verbosity:
--verbosity $verbosity
#end if
#include source=$ref_opts#
#include source=$vcf_output_opts#
#include source=$gatk_bam_input#
#include source=$gatk_ints_chth#
#include source=$gatk_excl_ints_chth#]]></command>
  <inputs>
    <expand macro="ref_sel"/>
    <expand macro="gatk_req_params"/>
    <expand macro="gzip_vcf_params"/>
    <expand macro="gatk_ints"/>
    <expand macro="gatk_excl_ints"/>
    <param name="active_probability_threshold" argument="--active-probability-threshold" type="float" optional="true" value="0.002" label="Active Probability Threshold" help="Minimum probability for a locus to be considered active."/>
    <param name="add_output_sam_program_record" argument="--add-output-sam-program-record" type="boolean" truevalue="--add-output-sam-program-record" falsevalue="" optional="true" checked="true" label="Add Output Sam Program Record" help="If true, adds a PG tag to created SAM/BAM/CRAM files."/>
    <param name="add_output_vcf_command_line" argument="--add-output-vcf-command-line" type="boolean" truevalue="--add-output-vcf-command-line" falsevalue="" optional="true" checked="true" label="Add Output Vcf Command Line" help="If true, adds a command line header line to created VCF files."/>
    <param name="all_site_pls" argument="--all-site-pls" type="boolean" truevalue="--all-site-pls" falsevalue="" optional="true" checked="false" label="All Site Pls" help="Annotate all sites with PLs"/>
    <param name="alleles" argument="--alleles" type="data" optional="true" format="vcf,vcf_bgzip" label="Alleles" help="The set of alleles at which to genotype when --genotyping_mode is GENOTYPE_GIVEN_ALLELES"/>
    <param name="allow_non_unique_kmers_in_ref" argument="--allow-non-unique-kmers-in-ref" type="boolean" truevalue="--allow-non-unique-kmers-in-ref" falsevalue="" optional="true" checked="false" label="Allow Non Unique Kmers In Ref" help="Allow graphs that have non-unique kmers in the reference"/>
    <param name="annotate_with_num_discovered_alleles" argument="--annotate-with-num-discovered-alleles" type="boolean" truevalue="--annotate-with-num-discovered-alleles" falsevalue="" optional="true" checked="false" label="Annotate With Num Discovered Alleles" help="If provided, we will annotate records with the number of alternate alleles that were discovered (but not necessarily genotyped) at a given site"/>
    <param name="assembly_region_padding" argument="--assembly-region-padding" type="integer" optional="true" value="100" label="Assembly Region Padding" help="Number of additional bases of context to include around each assembly region"/>
    <param name="bam_writer_type" argument="--bam-writer-type" type="select" optional="true" label="Bam Writer Type" help="Which haplotypes should be written to the BAM">
      <option selected="false" value="ALL_POSSIBLE_HAPLOTYPES">ALL_POSSIBLE_HAPLOTYPES</option>
      <option selected="true" value="CALLED_HAPLOTYPES">CALLED_HAPLOTYPES</option>
    </param>
    <param name="base_quality_score_threshold" argument="--base-quality-score-threshold" type="integer" optional="true" value="18" label="Base Quality Score Threshold" help="Base qualities below this threshold will be reduced to the minimum (6)"/>
    <param name="cloud_index_prefetch_buffer" argument="--cloud-index-prefetch-buffer" type="integer" optional="true" value="-1" label="Cloud Index Prefetch Buffer" help="Size of the cloud-only prefetch buffer (in MB; 0 to disable). Defaults to cloudPrefetchBuffer if unset."/>
    <param name="cloud_prefetch_buffer" argument="--cloud-prefetch-buffer" type="integer" optional="true" value="40" label="Cloud Prefetch Buffer" help="Size of the cloud-only prefetch buffer (in MB; 0 to disable)."/>
    <param name="comp" argument="--comp" type="data" optional="true" format="vcf,vcf_bgzip" label="Comp" help="Comparison VCF file(s)"/>
    <param name="consensus" argument="--consensus" type="boolean" truevalue="--consensus" falsevalue="" optional="true" checked="false" label="Consensus" help="1000G consensus mode"/>
    <param name="contamination_fraction_per_sample_file" argument="--contamination-fraction-per-sample-file" type="data" optional="true" format="tabular" label="Contamination Fraction Per Sample File" help="Tab-separated File containing fraction of contamination in sequencing data (per sample) to aggressively remove. Format should be &amp;quot;&amp;lt;SampleID&amp;gt;&amp;lt;TAB&amp;gt;&amp;lt;Contamination&amp;gt;&amp;quot; (Contamination is double) per line; No header."/>
    <param name="contamination_fraction_to_filter" argument="--contamination-fraction-to-filter" type="float" optional="true" value="0.0" label="Contamination Fraction To Filter" help="Fraction of contamination in sequencing data (for all samples) to aggressively remove"/>
    <param name="create_output_bam_index" argument="--create-output-bam-index" type="boolean" truevalue="--create-output-bam-index" falsevalue="" optional="true" checked="true" label="Create Output Bam Index" help="If true, create a BAM/CRAM index when writing a coordinate-sorted BAM/CRAM file."/>
    <param name="create_output_bam_md5" argument="--create-output-bam-md5" type="boolean" truevalue="--create-output-bam-md5" falsevalue="" optional="true" checked="false" label="Create Output Bam Md5" help="If true, create a MD5 digest for any BAM/SAM/CRAM file created"/>
    <param name="create_output_variant_index" argument="--create-output-variant-index" type="boolean" truevalue="--create-output-variant-index" falsevalue="" optional="true" checked="true" label="Create Output Variant Index" help="If true, create a VCF index when writing a coordinate-sorted VCF file."/>
    <param name="create_output_variant_md5" argument="--create-output-variant-md5" type="boolean" truevalue="--create-output-variant-md5" falsevalue="" optional="true" checked="false" label="Create Output Variant Md5" help="If true, create a a MD5 digest any VCF file created."/>
    <param name="dbsnp" argument="--dbsnp" type="data" optional="true" format="vcf,vcf_bgzip" label="Dbsnp" help="dbSNP file"/>
    <param name="debug" argument="--debug" type="boolean" truevalue="--debug" falsevalue="" optional="true" checked="false" label="Debug" help="Print out very verbose debug information about each triggering active region"/>
    <param name="disable_bam_index_caching" argument="--disable-bam-index-caching" type="boolean" truevalue="--disable-bam-index-caching" falsevalue="" optional="true" checked="false" label="Disable Bam Index Caching" help="If true, don&amp;apos;t cache bam indexes, this will reduce memory requirements but may harm performance if many intervals are specified.  Caching is automatically disabled if there are no intervals specified."/>
    <param name="disable_optimizations" argument="--disable-optimizations" type="boolean" truevalue="--disable-optimizations" falsevalue="" optional="true" checked="false" label="Disable Optimizations" help="Don&amp;apos;t skip calculations in ActiveRegions with no variants"/>
    <param name="disable_read_filter" argument="--disable-read-filter" type="text" optional="true" value="" label="Disable Read Filter" help="Read filters to be disabled before analysis"/>
    <param name="disable_sequence_dictionary_validation" argument="--disable-sequence-dictionary-validation" type="boolean" truevalue="--disable-sequence-dictionary-validation" falsevalue="" optional="true" checked="false" label="Disable Sequence Dictionary Validation" help="If specified, do not check the sequence dictionaries from our inputs for compatibility. Use at your own risk!"/>
    <param name="disable_tool_default_annotations" argument="--disable-tool-default-annotations" type="boolean" truevalue="--disable-tool-default-annotations" falsevalue="" optional="true" checked="false" label="Disable Tool Default Annotations" help="Disable all tool default annotations"/>
    <param name="disable_tool_default_read_filters" argument="--disable-tool-default-read-filters" type="boolean" truevalue="--disable-tool-default-read-filters" falsevalue="" optional="true" checked="false" label="Disable Tool Default Read Filters" help="Disable all tool default read filters (WARNING: many tools will not function correctly without their default read filters on)"/>
    <param name="do_not_run_physical_phasing" argument="--do-not-run-physical-phasing" type="boolean" truevalue="--do-not-run-physical-phasing" falsevalue="" optional="true" checked="false" label="Do Not Run Physical Phasing" help="Disable physical phasing"/>
    <param name="dont_increase_kmer_sizes_for_cycles" argument="--dont-increase-kmer-sizes-for-cycles" type="boolean" truevalue="--dont-increase-kmer-sizes-for-cycles" falsevalue="" optional="true" checked="false" label="Dont Increase Kmer Sizes For Cycles" help="Disable iterating over kmer sizes when graph cycles are detected"/>
    <param name="dont_trim_active_regions" argument="--dont-trim-active-regions" type="boolean" truevalue="--dont-trim-active-regions" falsevalue="" optional="true" checked="false" label="Dont Trim Active Regions" help="If specified, we will not trim down the active region from the full region (active + extension) to just the active interval for genotyping"/>
    <param name="dont_use_soft_clipped_bases" argument="--dont-use-soft-clipped-bases" type="boolean" truevalue="--dont-use-soft-clipped-bases" falsevalue="" optional="true" checked="false" label="Dont Use Soft Clipped Bases" help="Do not analyze soft clipped bases in the reads"/>
    <param name="emit_ref_confidence" argument="--emit-ref-confidence" type="select" optional="true" label="Emit Ref Confidence" help="Mode for emitting reference confidence scores">
      <option selected="true" value="NONE">NONE</option>
      <option selected="false" value="BP_RESOLUTION">BP_RESOLUTION</option>
      <option selected="false" value="GVCF">GVCF</option>
    </param>
    <param name="enable_all_annotations" argument="--enable-all-annotations" type="boolean" truevalue="--enable-all-annotations" falsevalue="" optional="true" checked="false" label="Enable All Annotations" help="Use all possible annotations (not for the faint of heart)"/>
    <param name="founder_id" argument="--founder-id" type="text" optional="true" value="" label="Founder Id" help="Samples representing the population &amp;quot;founders&amp;quot;"/>
    <param name="gatk_config_file" argument="--gatk-config-file" type="data" optional="true" format="txt" label="Gatk Config File" help="A configuration file to use with the GATK."/>
    <param name="gcs_max_retries" argument="--gcs-max-retries" type="integer" optional="true" value="20" label="Gcs Max Retries" help="If the GCS bucket channel errors out, how many times it will attempt to re-initiate the connection"/>
    <param name="genotype_filtered_alleles" argument="--genotype-filtered-alleles" type="boolean" truevalue="--genotype-filtered-alleles" falsevalue="" optional="true" checked="false" label="Genotype Filtered Alleles" help="Whether to genotype all given alleles, even filtered ones, --genotyping_mode is GENOTYPE_GIVEN_ALLELES"/>
    <param name="genotyping_mode" argument="--genotyping-mode" type="select" optional="true" label="Genotyping Mode" help="Specifies how to determine the alternate alleles to use for genotyping">
      <option selected="true" value="DISCOVERY">DISCOVERY</option>
      <option selected="false" value="GENOTYPE_GIVEN_ALLELES">GENOTYPE_GIVEN_ALLELES</option>
    </param>
    <param name="gvcf_gq_bands" argument="--gvcf-gq-bands" type="integer" optional="true" value="" label="Gvcf Gq Bands" help="Exclusive upper bounds for reference confidence GQ bands (must be in [1, 100] and specified in increasing order)"/>
    <param name="heterozygosity" argument="--heterozygosity" type="float" optional="true" value="0.001" label="Heterozygosity" help="Heterozygosity value used to compute prior likelihoods for any locus.  See the GATKDocs for full details on the meaning of this population genetics concept"/>
    <param name="heterozygosity_stdev" argument="--heterozygosity-stdev" type="float" optional="true" value="0.01" label="Heterozygosity Stdev" help="Standard deviation of heterozygosity for SNP and indel calling."/>
    <param name="indel_heterozygosity" argument="--indel-heterozygosity" type="float" optional="true" value="0.000125" label="Indel Heterozygosity" help="Heterozygosity for indel calling.  See the GATKDocs for heterozygosity for full details on the meaning of this population genetics concept"/>
    <param name="indel_size_to_eliminate_in_ref_model" argument="--indel-size-to-eliminate-in-ref-model" type="integer" optional="true" value="10" label="Indel Size To Eliminate In Ref Model" help="The size of an indel to check for in the reference model"/>
    <param name="input_prior" argument="--input-prior" type="text" optional="true" value="" label="Input Prior" help="Input prior for calls"/>
    <param name="interval_merging_rule" argument="--interval-merging-rule" type="select" optional="true" label="Interval Merging Rule" help="Interval merging rule for abutting intervals">
      <option selected="true" value="ALL">ALL</option>
      <option selected="false" value="OVERLAPPING_ONLY">OVERLAPPING_ONLY</option>
    </param>
    <param name="interval_set_rule" argument="--interval-set-rule" type="select" optional="true" label="Interval Set Rule" help="Set merging approach to use for combining interval inputs">
      <option selected="true" value="UNION">UNION</option>
      <option selected="false" value="INTERSECTION">INTERSECTION</option>
    </param>
    <param name="kmer_size" argument="--kmer-size" type="integer" optional="true" value="" label="Kmer Size" help="Kmer size to use in the read threading assembler"/>
    <param name="lenient" argument="--lenient" type="boolean" truevalue="--lenient" falsevalue="" optional="true" checked="false" label="Lenient" help="Lenient processing of VCF files"/>
    <param name="max_alternate_alleles" argument="--max-alternate-alleles" type="integer" optional="true" value="6" label="Max Alternate Alleles" help="Maximum number of alternate alleles to genotype"/>
    <param name="max_assembly_region_size" argument="--max-assembly-region-size" type="integer" optional="true" value="300" label="Max Assembly Region Size" help="Maximum size of an assembly region"/>
    <param name="max_genotype_count" argument="--max-genotype-count" type="integer" optional="true" value="1024" label="Max Genotype Count" help="Maximum number of genotypes to consider at any site"/>
    <param name="max_mnp_distance" argument="--max-mnp-distance" type="integer" optional="true" value="0" label="Max Mnp Distance" help="Two or more phased substitutions separated by this distance or less are merged into MNPs."/>
    <param name="max_num_haplotypes_in_population" argument="--max-num-haplotypes-in-population" type="integer" optional="true" value="128" label="Max Num Haplotypes In Population" help="Maximum number of haplotypes to consider for your population"/>
    <param name="max_prob_propagation_distance" argument="--max-prob-propagation-distance" type="integer" optional="true" value="50" label="Max Prob Propagation Distance" help="Upper limit on how many bases away probability mass can be moved around when calculating the boundaries between active and inactive assembly regions"/>
    <param name="max_reads_per_alignment_start" argument="--max-reads-per-alignment-start" type="integer" optional="true" value="50" label="Max Reads Per Alignment Start" help="Maximum number of reads to retain per alignment start position. Reads above this threshold will be downsampled. Set to 0 to disable."/>
    <param name="min_assembly_region_size" argument="--min-assembly-region-size" type="integer" optional="true" value="50" label="Min Assembly Region Size" help="Minimum size of an assembly region"/>
    <param name="min_base_quality_score" argument="--min-base-quality-score" type="integer" optional="true" value="10" label="Min Base Quality Score" help="Minimum base quality required to consider a base for calling"/>
    <param name="min_dangling_branch_length" argument="--min-dangling-branch-length" type="integer" optional="true" value="4" label="Min Dangling Branch Length" help="Minimum length of a dangling branch to attempt recovery"/>
    <param name="min_pruning" argument="--min-pruning" type="integer" optional="true" value="2" label="Min Pruning" help="Minimum support to not prune paths in the graph"/>
    <param name="native_pair_hmm_threads" argument="--native-pair-hmm-threads" type="integer" optional="true" value="4" label="Native Pair Hmm Threads" help="How many threads should a native pairHMM implementation use"/>
    <param name="native_pair_hmm_use_double_precision" argument="--native-pair-hmm-use-double-precision" type="boolean" truevalue="--native-pair-hmm-use-double-precision" falsevalue="" optional="true" checked="false" label="Native Pair Hmm Use Double Precision" help="use double precision in the native pairHmm. This is slower but matches the java implementation better"/>
    <param name="num_pruning_samples" argument="--num-pruning-samples" type="integer" optional="true" value="1" label="Num Pruning Samples" help="Number of samples that must pass the minPruning threshold"/>
    <param name="num_reference_samples_if_no_call" argument="--num-reference-samples-if-no-call" type="integer" optional="true" value="0" label="Num Reference Samples If No Call" help="Number of hom-ref genotypes to infer at sites not present in a panel"/>
    <param name="output_mode" argument="--output-mode" type="select" optional="true" label="Output Mode" help="Specifies which type of calls we should output">
      <option selected="true" value="EMIT_VARIANTS_ONLY">EMIT_VARIANTS_ONLY</option>
      <option selected="false" value="EMIT_ALL_CONFIDENT_SITES">EMIT_ALL_CONFIDENT_SITES</option>
      <option selected="false" value="EMIT_ALL_SITES">EMIT_ALL_SITES</option>
    </param>
    <param name="pair_hmm_gap_continuation_penalty" argument="--pair-hmm-gap-continuation-penalty" type="integer" optional="true" value="10" label="Pair Hmm Gap Continuation Penalty" help="Flat gap continuation penalty for use in the Pair HMM"/>
    <param name="pair_hmm_implementation" argument="--pair-hmm-implementation" type="select" optional="true" label="Pair Hmm Implementation" help="The PairHMM implementation to use for genotype likelihood calculations">
      <option selected="false" value="EXACT">EXACT</option>
      <option selected="false" value="ORIGINAL">ORIGINAL</option>
      <option selected="false" value="LOGLESS_CACHING">LOGLESS_CACHING</option>
      <option selected="false" value="AVX_LOGLESS_CACHING">AVX_LOGLESS_CACHING</option>
      <option selected="false" value="AVX_LOGLESS_CACHING_OMP">AVX_LOGLESS_CACHING_OMP</option>
      <option selected="false" value="EXPERIMENTAL_FPGA_LOGLESS_CACHING">EXPERIMENTAL_FPGA_LOGLESS_CACHING</option>
      <option selected="true" value="FASTEST_AVAILABLE">FASTEST_AVAILABLE</option>
    </param>
    <param name="pcr_indel_model" argument="--pcr-indel-model" type="select" optional="true" label="Pcr Indel Model" help="The PCR indel model to use">
      <option selected="false" value="NONE">NONE</option>
      <option selected="false" value="HOSTILE">HOSTILE</option>
      <option selected="false" value="AGGRESSIVE">AGGRESSIVE</option>
      <option selected="true" value="CONSERVATIVE">CONSERVATIVE</option>
    </param>
    <param name="pedigree" argument="--pedigree" type="data" optional="true" format="tabular" label="Pedigree" help="Pedigree file for determining the population &amp;quot;founders&amp;quot;"/>
    <param name="phred_scaled_global_read_mismapping_rate" argument="--phred-scaled-global-read-mismapping-rate" type="integer" optional="true" value="45" label="Phred Scaled Global Read Mismapping Rate" help="The global assumed mismapping rate for reads"/>
    <param name="population_callset" argument="--population-callset" type="data" optional="true" format="vcf,vcf_bgzip" label="Population Callset" help="Callset to use in calculating genotype priors"/>
    <param name="read_filter" argument="--read-filter" type="text" optional="true" value="" label="Read Filter" help="Read filters to be applied before analysis"/>
    <param name="read_validation_stringency" argument="--read-validation-stringency" type="select" optional="true" label="Read Validation Stringency" help="Validation stringency for all SAM/BAM/CRAM/SRA files read by this program.  The default stringency value SILENT can improve performance when processing a BAM file in which variable-length data (read, qualities, tags) do not otherwise need to be decoded.">
      <option selected="false" value="STRICT">STRICT</option>
      <option selected="false" value="LENIENT">LENIENT</option>
      <option selected="true" value="SILENT">SILENT</option>
    </param>
    <param name="recover_dangling_heads" argument="--recover-dangling-heads" type="boolean" truevalue="--recover-dangling-heads" falsevalue="" optional="true" checked="false" label="Recover Dangling Heads" help="This argument is deprecated since version 3.3"/>
    <param name="sample_name" argument="--sample-name" type="text" optional="true" value="" label="Sample Name" help="Name of single sample to use from a multi-sample bam"/>
    <param name="sample_ploidy" argument="--sample-ploidy" type="integer" optional="true" value="2" label="Sample Ploidy" help="Ploidy (number of chromosomes) per sample. For pooled data, set to (Number of samples in each pool * Sample Ploidy)."/>
    <param name="seconds_between_progress_updates" argument="--seconds-between-progress-updates" type="float" optional="true" value="10.0" label="Seconds Between Progress Updates" help="Output traversal statistics every time this many seconds elapse"/>
    <param name="sites_only_vcf_output" argument="--sites-only-vcf-output" type="boolean" truevalue="--sites-only-vcf-output" falsevalue="" optional="true" checked="false" label="Sites Only Vcf Output" help="If true, don&amp;apos;t emit genotype fields when writing vcf file output."/>
    <param name="smith_waterman" argument="--smith-waterman" type="select" optional="true" label="Smith Waterman" help="Which Smith-Waterman implementation to use, generally FASTEST_AVAILABLE is the right choice">
      <option selected="false" value="FASTEST_AVAILABLE">FASTEST_AVAILABLE</option>
      <option selected="false" value="AVX_ENABLED">AVX_ENABLED</option>
      <option selected="true" value="JAVA">JAVA</option>
    </param>
    <param name="standard_min_confidence_threshold_for_calling" argument="--standard-min-confidence-threshold-for-calling" type="float" optional="true" value="10.0" label="Standard Min Confidence Threshold For Calling" help="The minimum phred-scaled confidence threshold at which variants should be called"/>
    <param name="use_alleles_trigger" argument="--use-alleles-trigger" type="boolean" truevalue="--use-alleles-trigger" falsevalue="" optional="true" checked="false" label="Use Alleles Trigger" help="Use additional trigger on variants found in an external alleles file"/>
    <param name="use_filtered_reads_for_annotations" argument="--use-filtered-reads-for-annotations" type="boolean" truevalue="--use-filtered-reads-for-annotations" falsevalue="" optional="true" checked="false" label="Use Filtered Reads For Annotations" help="Use the contamination-filtered read maps for the purposes of annotating variants"/>
    <param name="use_jdk_deflater" argument="--use-jdk-deflater" type="boolean" truevalue="--use-jdk-deflater" falsevalue="" optional="true" checked="false" label="Use Jdk Deflater" help="Whether to use the JdkDeflater (as opposed to IntelDeflater)"/>
    <param name="use_jdk_inflater" argument="--use-jdk-inflater" type="boolean" truevalue="--use-jdk-inflater" falsevalue="" optional="true" checked="false" label="Use Jdk Inflater" help="Whether to use the JdkInflater (as opposed to IntelInflater)"/>
    <param name="use_new_qual_calculator" argument="--use-new-qual-calculator" type="boolean" truevalue="--use-new-qual-calculator" falsevalue="" optional="true" checked="false" label="Use New Qual Calculator" help="If provided, we will use the new AF model instead of the so-called exact model"/>
    <param name="verbosity" argument="--verbosity" type="select" optional="true" label="Verbosity" help="Control verbosity of logging.">
      <option selected="false" value="ERROR">ERROR</option>
      <option selected="false" value="WARNING">WARNING</option>
      <option selected="true" value="INFO">INFO</option>
      <option selected="false" value="DEBUG">DEBUG</option>
    </param>
    <param argument="--activity_profile_out_sel" checked="false" falsevalue="" help="Output the raw activity profile results in IGV format" label="Activity Profile Out" name="activity_profile_out_sel" optional="true" truevalue="--activity_profile_out_sel" type="boolean"/>
    <param argument="--assembly_region_out_sel" checked="false" falsevalue="" help="Output the assembly region to this IGV formatted file" label="Assembly Region Out" name="assembly_region_out_sel" optional="true" truevalue="--assembly_region_out_sel" type="boolean"/>
    <param argument="--bam_output_sel" checked="false" falsevalue="" help="File to which assembled haplotypes should be written" label="Bam Output" name="bam_output_sel" optional="true" truevalue="--bam_output_sel" type="boolean"/>
    <param argument="--graph_output_sel" checked="false" falsevalue="" help="Write debug assembly graph information to this file" label="Graph Output" name="graph_output_sel" optional="true" truevalue="--graph_output_sel" type="boolean"/>
  </inputs>
  <outputs>
    <expand macro="gzip_vcf_output_params"/>
    <data format="tabular" name="activity_profile_out" label="${tool.name} on ${on_string}: activity_profile_out tabular" help="Output the raw activity profile results in IGV format">
      <filter>activity_profile_out_sel</filter>
    </data>
    <data format="tabular" name="assembly_region_out" label="${tool.name} on ${on_string}: assembly_region_out tabular" help="Output the assembly region to this IGV formatted file">
      <filter>assembly_region_out_sel</filter>
    </data>
    <data format="bam" name="bam_output" label="${tool.name} on ${on_string}: bam_output bam" help="File to which assembled haplotypes should be written">
      <filter>bam_output_sel</filter>
    </data>
    <data format="txt" name="graph_output" label="${tool.name} on ${on_string}: graph_output txt" help="Write debug assembly graph information to this file">
      <filter>graph_output_sel</filter>
    </data>
  </outputs>
  <tests/>
  <help><![CDATA[Call germline SNPs and indels via local re-assembly of haplotypes

The HaplotypeCaller is capable of calling SNPs and indels simultaneously
via local de-novo assembly of haplotypes in an active region. In other
words, whenever the program encounters a region showing signs of
variation, it discards the existing mapping information and completely
reassembles the reads in that region. This allows the HaplotypeCaller to
be more accurate when calling regions that are traditionally difficult
to call, for example when they contain different types of variants close
to each other. It also makes the HaplotypeCaller much better at calling
indels than position-based callers like UnifiedGenotyper.

In the GVCF workflow used for scalable variant calling in DNA sequence
data, HaplotypeCaller runs per-sample to generate an intermediate GVCF
(not to be used in final analysis), which can then be used in
GenotypeGVCFs for joint genotyping of multiple samples in a very
efficient way. The GVCF workflow enables rapid incremental processing of
samples as they roll off the sequencer, as well as scaling to very large
cohort sizes (e.g. the 92K exomes of ExAC).

In addition, HaplotypeCaller is able to handle non-diploid organisms as
well as pooled experiment data. Note however that the algorithms used to
calculate variant likelihoods is not well suited to extreme allele
frequencies (relative to ploidy) so its use is not recommended for
somatic (cancer) variant discovery. For that purpose, use Mutect2
instead.

Finally, HaplotypeCaller is also able to correctly handle the splice
junctions that make RNAseq a challenge for most variant callers, on the
condition that the input read data has previously been processed
according to our recommendations as documented
`here <https://software.broadinstitute.org/gatk/documentation/article?id=4067>`__.

How HaplotypeCaller works
~~~~~~~~~~~~~~~~~~~~~~~~~

| 

`1. Define active regions <https://software.broadinstitute.org/gatk/documentation/article?id=4147>`__
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

| The program determines which regions of the genome it needs to operate
  on (active regions), based on the presence of evidence for variation.

`2. Determine haplotypes by assembly of the active region <https://software.broadinstitute.org/gatk/documentation/article?id=4146>`__
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

For each active region, the program builds a De Bruijn-like graph to
reassemble the active region and identifies what are the possible
haplotypes present in the data. The program then realigns each haplotype
against the reference haplotype using the Smith-Waterman algorithm in
order to identify potentially variant sites.

| 

`3. Determine likelihoods of the haplotypes given the read data <https://software.broadinstitute.org/gatk/documentation/article?id=4441>`__
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

For each active region, the program performs a pairwise alignment of
each read against each haplotype using the PairHMM algorithm. This
produces a matrix of likelihoods of haplotypes given the read data.
These likelihoods are then marginalized to obtain the likelihoods of
alleles for each potentially variant site given the read data.

| 

`4. Assign sample genotypes <https://software.broadinstitute.org/gatk/documentation/article?id=4442>`__
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

For each potentially variant site, the program applies Bayes' rule,
using the likelihoods of alleles given the read data to calculate the
likelihoods of each genotype per sample given the read data observed for
that sample. The most likely genotype is then assigned to the sample.

Input
~~~~~

Input bam file(s) from which to make variant calls

Output
~~~~~~

Either a VCF or GVCF file with raw, unfiltered SNP and indel calls.
Regular VCFs must be filtered either by variant recalibration (Best
Practice) or hard-filtering before use in downstream analyses. If using
the GVCF workflow, the output is a GVCF file that must first be run
through GenotypeGVCFs and then filtering before further analysis.

Usage examples
~~~~~~~~~~~~~~

These are example commands that show how to run HaplotypeCaller for
typical use cases. Have a look at the `method
documentation <https://software.broadinstitute.org/gatk/documentation/article?id=3893>`__
for the basic GVCF workflow.

| 

Single-sample GVCF calling (outputs intermediate GVCF)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    gatk --java-options "-Xmx4g" HaplotypeCaller  \
      -R Homo_sapiens_assembly38.fasta \
      -I input.bam \
      -O output.g.vcf.gz \
      -ERC GVCF
    

Single-sample GVCF calling with `allele-specific annotations <https://software.broadinstitute.org/gatk/documentation/article?id=9622>`__
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    gatk --java-options "-Xmx4g" HaplotypeCaller  \
      -R Homo_sapiens_assembly38.fasta \
      -I input.bam \
      -O output.g.vcf.gz \
      -ERC GVCF \
      -G Standard \
      -G AS_Standard
    

Variant calling with `bamout <https://software.broadinstitute.org/gatk/documentation/article?id=5484>`__ to show realigned reads
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

::

    gatk --java-options "-Xmx4g" HaplotypeCaller  \
      -R Homo_sapiens_assembly38.fasta \
      -I input.bam \
      -O output.vcf.gz \
      -bamout bamout.bam
    

Caveats
~~~~~~~

-  We have not yet fully tested the interaction between the GVCF-based
   calling or the multisample calling and the RNAseq-specific
   functionalities. Use those in combination at your own risk.

Special note on ploidy
~~~~~~~~~~~~~~~~~~~~~~

This tool is able to handle many non-diploid use cases; the desired
ploidy can be specified using the -ploidy argument. Note however that
very high ploidies (such as are encountered in large pooled experiments)
may cause performance challenges including excessive slowness. We are
working on resolving these limitations.

Additional Notes
~~~~~~~~~~~~~~~~

-  When working with PCR-free data, be sure to set \`-pcr_indel_model
   NONE\` (see argument below).
-  When running in \`-ERC GVCF\` or \`-ERC BP_RESOLUTION\` modes, the
   confidence threshold is automatically set to 0. This cannot be
   overridden by the command line. The threshold can be set manually to
   the desired level in the next step of the workflow (GenotypeGVCFs)
-  We recommend using a list of intervals to speed up analysis. See
   `this
   document <https://software.broadinstitute.org/gatk/documentation/article?id=4133>`__
   for details.
]]></help>
  <citations>
    <expand macro="citations"/>
  </citations>
</tool>
